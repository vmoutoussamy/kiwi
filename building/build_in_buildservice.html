

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Building in the Open Build Service &mdash; kiwi 9.18.10 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Working with Images" href="working_with_images.html" />
    <link rel="prev" title="Building Images with Profiles" href="build_with_profiles.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> kiwi
          

          
            
            <img src="../_static/kiwi-logo.png" class="logo" alt="Logo"/>
          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../quickstart.html">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#before-you-start">Before you start</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#choose-a-first-image">Choose a First Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#build-your-first-image">Build your First Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#run-your-image">Run your Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="../quickstart.html#tweak-and-customize-your-image">Tweak and Customize your Image</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installation-from-obs">Installation from OBS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installation-from-your-distribution-s-repositories">Installation from your distribution’s repositories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#installation-from-pypi">Installation from PyPI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation.html#example-appliance-descriptions">Example Appliance Descriptions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../working_with_kiwi.html">Working with KIWI</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../working_with_kiwi/xml_description.html">The Image Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_kiwi/xml_description.html#the-image-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">image</span></code> Element</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_kiwi/xml_description.html#the-description-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">description</span></code> Element</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_kiwi/xml_description.html#the-preferences-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">preferences</span></code> Element</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../working_with_kiwi/xml_description.html#build-types">Build Types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../working_with_kiwi/xml_description.html#common-attributes-of-the-type-element">Common attributes of the <code class="xref py py-obj docutils literal notranslate"><span class="pre">type</span></code> element</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../working_with_kiwi/xml_description.html#common-elements">Common Elements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_kiwi/xml_description.html#image-profiles">Image Profiles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_kiwi/xml_description.html#adding-users">Adding Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_kiwi/xml_description.html#defining-repositories-and-adding-or-removing-packages">Defining Repositories and Adding or Removing Packages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../working_with_kiwi/xml_description.html#adding-repositories">Adding repositories</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../working_with_kiwi/xml_description.html#supported-repository-paths">Supported repository paths</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../working_with_kiwi/xml_description.html#adding-and-removing-packages">Adding and removing packages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../working_with_kiwi/xml_description.html#the-package-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">package</span></code> element</a></li>
<li class="toctree-l4"><a class="reference internal" href="../working_with_kiwi/xml_description.html#the-archive-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">archive</span></code> element</a></li>
<li class="toctree-l4"><a class="reference internal" href="../working_with_kiwi/xml_description.html#uninstall-system-packages">Uninstall System Packages</a></li>
<li class="toctree-l4"><a class="reference internal" href="../working_with_kiwi/xml_description.html#the-product-and-namedcollection-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">product</span></code> and <code class="xref py py-obj docutils literal notranslate"><span class="pre">namedCollection</span></code> element</a></li>
<li class="toctree-l4"><a class="reference internal" href="../working_with_kiwi/xml_description.html#the-ignore-element">The <code class="xref py py-obj docutils literal notranslate"><span class="pre">ignore</span></code> element</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_kiwi/shell_scripts.html">User Defined Scripts</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../working_with_kiwi/shell_scripts.html#image-customization-via-the-config-sh-shell-script">Image Customization via the <code class="docutils literal notranslate"><span class="pre">config.sh</span></code> Shell Script</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../working_with_kiwi/shell_scripts.html#configuration-tips">Configuration Tips</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../working_with_kiwi/shell_scripts.html#image-customization-via-the-images-sh-shell-script">Image Customization via the <code class="docutils literal notranslate"><span class="pre">images.sh</span></code> Shell Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="../working_with_kiwi/shell_scripts.html#functions-and-variables-provided-by-kiwi">Functions and Variables Provided by KIWI</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../working_with_kiwi/shell_scripts.html#provided-functions">Provided Functions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../working_with_kiwi/shell_scripts.html#profile-environment-variables">Profile Environment Variables</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_kiwi/runtime_configuration.html">The Runtime Configuration File</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_kiwi/customize_the_boot_process.html">Customizing the Boot Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../working_with_kiwi/customize_the_boot_process.html#boot-image-hook-scripts">Boot Image Hook-Scripts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../working_with_kiwi/customize_the_boot_process.html#boot-image-parameters">Boot Image Parameters</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../working_with_kiwi/customize_the_boot_process.html#boot-debugging">Boot Debugging</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_kiwi/legacy_kiwi.html">Legacy KIWI vs. Next Generation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../working_with_kiwi/legacy_kiwi.html#when-do-i-need-to-use-the-legacy-kiwi">When Do I need to use the legacy kiwi</a></li>
<li class="toctree-l3"><a class="reference internal" href="../working_with_kiwi/legacy_kiwi.html#dropped-features">Dropped Features</a></li>
<li class="toctree-l3"><a class="reference internal" href="../working_with_kiwi/legacy_kiwi.html#compatibility">Compatibility</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_kiwi.html#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../working_with_kiwi.html#image-building-process">Image Building Process</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../working_with_kiwi.html#the-prepare-step">The Prepare Step</a></li>
<li class="toctree-l3"><a class="reference internal" href="../working_with_kiwi.html#the-create-step">The Create Step</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../overview/workflow.html">Basic Workflow</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../overview/workflow.html#components-of-an-image-description">Components of an Image Description</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#conceptual-overview">Conceptual Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#terminology">Terminology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../overview.html#system-requirements">System Requirements</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../building.html">Building Images</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="build_live_iso.html">Build an ISO Hybrid Live Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_vmx_disk.html">Build a Virtual Disk Image</a><ul>
<li class="toctree-l3"><a class="reference internal" href="build_vmx_disk.html#modifying-the-size-of-the-image">Modifying the Size of the Image</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_vmx_disk.html#customizing-the-virtual-machine">Customizing the Virtual Machine</a><ul>
<li class="toctree-l4"><a class="reference internal" href="build_vmx_disk.html#modifying-the-vm-configuration-directly">Modifying the VM Configuration Directly</a></li>
<li class="toctree-l4"><a class="reference internal" href="build_vmx_disk.html#adding-network-interfaces-to-the-vm">Adding Network Interfaces to the VM</a></li>
<li class="toctree-l4"><a class="reference internal" href="build_vmx_disk.html#specifying-disks-and-disk-controllers">Specifying Disks and Disk Controllers</a></li>
<li class="toctree-l4"><a class="reference internal" href="build_vmx_disk.html#adding-cd-dvd-drives">Adding CD/DVD Drives</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="build_oem_disk.html">Build an OEM Expandable Disk Image</a><ul>
<li class="toctree-l3"><a class="reference internal" href="build_oem_disk.html#deployment-methods">Deployment Methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_oem_disk.html#manual-deployment">Manual Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_oem_disk.html#cd-dvd-deployment">CD/DVD Deployment</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_oem_disk.html#network-deployment">Network Deployment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="build_pxe_root_filesystem.html">Build a PXE Root File System Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_docker_container.html">Build a Docker Container Image</a></li>
<li class="toctree-l2"><a class="reference internal" href="build_containerized.html">Building in a Self-Contained Environment</a><ul>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#requirements">Requirements</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#installing-and-setting-up-dice">Installing and Setting up Dice</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#installing-and-setting-up-docker">Installing and Setting up Docker</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#installing-and-setting-up-the-build-container">Installing and Setting up the Build Container</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#installing-and-setting-up-vagrant">Installing and Setting up Vagrant</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#configuring-dice">Configuring Dice</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#selecting-a-kiwi-template">Selecting a KIWI Template</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#the-dicefile">The Dicefile</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#building-with-dice">Building with Dice</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#buildsystem-backends">Buildsystem Backends</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#building-with-the-host-buildsystem">Building with the Host Buildsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#id1">The Dicefile</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#building-with-the-vagrant-buildsystem">Building with the Vagrant Buildsystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#id2">The Dicefile</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#the-vagrant-setup-for-the-docker-provider">The Vagrant setup for the Docker Provider</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#the-vagrantfile">The Vagrantfile</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#the-vagrant-setup-for-the-libvirt-provider">The Vagrant setup for the libvirt Provider</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#the-vagrant-build-box">The Vagrant Build Box</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_containerized.html#id3">The Vagrantfile</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="build_with_profiles.html">Building Images with Profiles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="build_with_profiles.html#local-builds">Local Builds</a></li>
<li class="toctree-l3"><a class="reference internal" href="build_with_profiles.html#building-with-the-open-build-service">Building with the Open Build Service</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Building in the Open Build Service</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#advantages-of-using-the-open-build-service-obs">Advantages of using the Open Build Service (OBS)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#differences-between-building-locally-and-on-obs">Differences Between Building Locally and on OBS</a></li>
<li class="toctree-l3"><a class="reference internal" href="#recommendations">Recommendations</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#working-with-obs">Working with OBS</a></li>
<li class="toctree-l4"><a class="reference internal" href="#repository-configuration">Repository Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#project-configuration">Project Configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="working_with_images.html">Working with Images</a><ul>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/iso_to_usb_stick_deployment.html">Deploy ISO Image on an USB Stick</a></li>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/iso_to_usb_stick_file_based_deployment.html">Deploy ISO Image as File on a FAT32 Formated USB Stick</a></li>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/vmx_setup_for_ec2.html">KIWI Image Description for Amazon EC2</a></li>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/vmx_setup_for_azure.html">KIWI Image Description for Microsoft Azure</a></li>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/vmx_setup_for_google.html">KIWI Image Description for Google Compute Engine</a></li>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/setup_pxe_bootserver.html">Setting Up a Network Boot Server</a><ul>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/setup_pxe_bootserver.html#installing-and-configuring-atftp">Installing and Configuring atftp</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/setup_pxe_bootserver.html#installing-and-configuring-dhcp">Installing and Configuring DHCP</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/setup_yast_on_first_boot.html">Setting Up YaST at First Boot</a></li>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/pxe_client_configuration.html">PXE Client Setup Configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/pxe_client_configuration.html#setup-client-with-remote-root">Setup Client with Remote Root</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/pxe_client_configuration.html#setup-client-with-system-on-local-disk">Setup Client with System on Local Disk</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/pxe_client_configuration.html#setup-client-with-system-on-local-md-raid-disk">Setup Client with System on Local MD RAID Disk</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/pxe_client_configuration.html#setup-loading-of-custom-configuration-file-s">Setup Loading of Custom Configuration File(s)</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/pxe_client_configuration.html#setup-client-to-force-reload-image">Setup Client to Force Reload Image</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/pxe_client_configuration.html#setup-client-to-force-reload-configuration-files">Setup Client to Force Reload Configuration Files</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/pxe_client_configuration.html#setup-client-for-reboot-after-deployment">Setup Client for Reboot After Deployment</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/pxe_client_configuration.html#setup-custom-kernel-boot-options">Setup custom kernel boot options</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/pxe_client_configuration.html#setup-a-custom-boot-timeout">Setup a Custom Boot Timeout</a></li>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/pxe_client_configuration.html#setup-a-different-download-protocol-and-server">Setup a Different Download Protocol and Server</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/vagrant_setup.html">KIWI Image Description for Vagrant</a><ul>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/vagrant_setup.html#customizing-the-embedded-vagrantfile">Customizing the embedded Vagrantfile</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/pxe_live_iso_boot.html">Booting a Live ISO Image from Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/oem_ramdisk_deployment.html">Deploy and Run System in a RamDisk</a></li>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/custom_partitions.html">Custom Disk Partitions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="working_with_images/custom_partitions.html#custom-partitioning-at-boot-time">Custom Partitioning at Boot Time</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/custom_volumes.html">Custom Disk Volumes</a></li>
<li class="toctree-l3"><a class="reference internal" href="working_with_images/custom_fstab_extension.html">Add or Update the Fstab File</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../building.html#supported-distributions">Supported Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../building.html#supported-platforms-and-architectures">Supported Platforms and Architectures</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../commands.html">KIWI Commands</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../commands/kiwi.html">kiwi</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands/kiwi.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/kiwi.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/kiwi.html#global-options">GLOBAL OPTIONS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/kiwi.html#example">EXAMPLE</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/kiwi.html#the-runtime-configuration-file">The Runtime Configuration File</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/kiwi.html#compatibility">COMPATIBILITY</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../commands/result_list.html">kiwi result list</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands/result_list.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/result_list.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/result_list.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../commands/result_bundle.html">kiwi result bundle</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands/result_bundle.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/result_bundle.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/result_bundle.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../commands/system_prepare.html">kiwi system prepare</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands/system_prepare.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/system_prepare.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/system_prepare.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../commands/system_update.html">kiwi system update</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands/system_update.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/system_update.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/system_update.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../commands/system_build.html">kiwi system build</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands/system_build.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/system_build.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/system_build.html#options">OPTIONS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/system_build.html#uri-types">URI_TYPES</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../commands/system_create.html">kiwi system create</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands/system_create.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/system_create.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/system_create.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../commands/image_resize.html">kiwi image resize</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands/image_resize.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/image_resize.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/image_resize.html#options">OPTIONS</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../commands/image_info.html">kiwi image info</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../commands/image_info.html#synopsis">SYNOPSIS</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/image_info.html#description">DESCRIPTION</a></li>
<li class="toctree-l3"><a class="reference internal" href="../commands/image_info.html#options">OPTIONS</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../development.html">Development and Contributing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../development/kiwi_from_python.html">Using KIWI NG in a Python Project</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/api/kiwi.html">API Documentation 9.18.10</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../development/api/kiwi.archive.html">kiwi.archive Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/api/kiwi.boot.html">kiwi.boot Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/api/kiwi.bootloader.html">kiwi.bootloader Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/api/kiwi.builder.html">kiwi.builder Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/api/kiwi.container.html">kiwi.container Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/api/kiwi.filesystem.html">kiwi.filesystem Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/api/kiwi.iso_tools.html">kiwi.iso_tools Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/api/kiwi.package_manager.html">kiwi.package_manager Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/api/kiwi.partitioner.html">kiwi.partitioner Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/api/kiwi.repository.html">kiwi.repository Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/api/kiwi.storage.html">kiwi.storage Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/api/kiwi.system.html">kiwi.system Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/api/kiwi.solver.html">kiwi.solver Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/api/kiwi.tasks.html">kiwi.tasks package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/api/kiwi.utils.html">kiwi.utils Package</a></li>
<li class="toctree-l4"><a class="reference internal" href="../development/api/kiwi.volume_manager.html">kiwi.volume_manager Package</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#submodules">Submodules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.app"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.app</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.cli"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.cli</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.command"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.command</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.command_process"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.command_process</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.defaults"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.defaults</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.exceptions"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.exceptions</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.firmware"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.firmware</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.help"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.help</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.kiwi"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.kiwi</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.logger"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.logger</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.mount_manager"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.mount_manager</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.path"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.path</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.privileges"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.privileges</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.runtime_checker"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.runtime_checker</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.runtime_config"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.runtime_config</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.version"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.version</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.xml_description"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.xml_description</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi.xml_state"><code class="xref py py-obj docutils literal notranslate"><span class="pre">kiwi.xml_state</span></code> Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/api/kiwi.html#module-kiwi">Module Contents</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../development/schema.html">Schema Documentation 7.1</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development/schema_extensions.html">Extending KIWI with Custom Operations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development/schema_extensions.html#the-extension-section">The &lt;extension&gt; Section</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/schema_extensions.html#relax-ng-schema-for-the-extension">RELAX NG Schema for the Extension</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/schema_extensions.html#extension-schema-in-xml-catalog">Extension Schema in XML catalog</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development/schema_extensions.html#using-the-extension">Using the Extension</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../development.html#fork-the-upstream-kiwi-repository">Fork the upstream KIWI repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development.html#create-a-local-clone-of-the-forked-kiwi-repository">Create a local clone of the forked KIWI repository</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development.html#install-required-operating-system-packages">Install Required Operating System Packages</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development.html#create-a-python-virtual-development-environment">Create a Python Virtual Development Environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development.html#running-the-unit-tests">Running the Unit Tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development.html#create-a-branch-for-each-feature-or-bugfix">Create a Branch for each Feature or Bugfix</a></li>
<li class="toctree-l2"><a class="reference internal" href="../development.html#coding-style">Coding Style</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development.html#documentation">Documentation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../development.html#additional-information">Additional Information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../development.html#signing-git-patches">Signing Git Patches</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development.html#bumping-the-version">Bumping the Version</a></li>
<li class="toctree-l3"><a class="reference internal" href="../development.html#creating-a-rpm-package">Creating a RPM Package</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">kiwi</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../building.html">Building Images</a> &raquo;</li>
        
      <li>Building in the Open Build Service</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/building/build_in_buildservice.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="building-in-the-open-build-service">
<h1>Building in the Open Build Service<a class="headerlink" href="#building-in-the-open-build-service" title="Permalink to this headline">¶</a></h1>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p><strong>Abstract</strong></p>
<p>This document gives a brief overview how to build images with
KIWI in version 9.18.10 inside of the Open Build Service.
A tutorial on the Open Buildservice itself can be found here:
<a class="reference external" href="https://en.opensuse.org/openSUSE:Build_Service_Tutorial">https://en.opensuse.org/openSUSE:Build_Service_Tutorial</a></p>
</div>
<p>The next generation KIWI is fully integrated with the Open Build Service.
In order to start it’s best to checkout one of the integration test
image build projects from the base Testing project
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Virtualization:Appliances:Images:Testing_$ARCH</span></code> at:</p>
<p><a class="reference external" href="https://build.opensuse.org">https://build.opensuse.org</a></p>
<p>For example the test images for x86 can be found <a class="reference external" href="https://build.opensuse.org/project/show/Virtualization:Appliances:Images:Testing_x86">here</a>.</p>
<div class="section" id="advantages-of-using-the-open-build-service-obs">
<h2>Advantages of using the Open Build Service (OBS)<a class="headerlink" href="#advantages-of-using-the-open-build-service-obs" title="Permalink to this headline">¶</a></h2>
<p>The Open Build Service offers multiple advantages over running KIWI
locally:</p>
<ul class="simple">
<li><p>OBS will host the latest successful build for you without having to setup
a server yourself.</p></li>
<li><p>As KIWI is fully integrated into OBS, OBS will automatically rebuild your
images if one of the included packages or one of its dependencies or KIWI
itself get updated.</p></li>
<li><p>The builds will no longer have to be executed on your own machine, but
will run on OBS, thereby saving you resources. Nevertheless, if a build
fails, you get a notification via email (if enabled in your user’s
preferences).</p></li>
</ul>
</div>
<div class="section" id="differences-between-building-locally-and-on-obs">
<h2>Differences Between Building Locally and on OBS<a class="headerlink" href="#differences-between-building-locally-and-on-obs" title="Permalink to this headline">¶</a></h2>
<p>Note, there is a number of differences when building images with KIWI using
the Open Build Service. Your image that build locally just fine, might not
build without modifications.</p>
<p>The notable differences to running KIWI locally include:</p>
<ul>
<li><p>OBS will pick the KIWI package from the repositories configured in your
project, which will most likely not be the same version that you are
running locally.
This is especially relevant when building images for older versions like
SUSE Linux Enterprise. Therefore, include the custom appliances
repository as described in the following section:
<a class="reference internal" href="#obs-recommended-settings"><span class="std std-ref">Recommendations</span></a>.</p></li>
<li><p>When KIWI runs on OBS, OBS will extract the list of packages from
<code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> and use it to create a build root. In contrast to a
local build (where your distributions package manager will resolve the
dependencies and install the packages), OBS will <strong>not</strong> build your image
if there are multiple packages that could be chosen to satisfy the
dependencies of your packages <a class="footnote-reference brackets" href="#f1" id="id1">1</a>. This shows errors like this:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>unresolvable: have choice <span class="k">for</span> SOMEPACKAGE: SOMEPAKAGE_1 SOMEPACKAGE_2
</pre></div>
</div>
<p>This can be solved by explicitly specifying one of the two packages in
the project configuration via the following setting:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Prefer: SOMEPACKAGE_1
</pre></div>
</div>
<p>Place the above line into the project configuration, which can be
accessed either via the web interface (click on the tab <code class="docutils literal notranslate"><span class="pre">Project</span>
<span class="pre">Config</span></code> on your project’s main page) or via <code class="docutils literal notranslate"><span class="pre">osc</span> <span class="pre">meta</span> <span class="pre">-e</span> <span class="pre">prjconf</span></code>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>We strongly encourage you to remove your repositories from
<code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> and move them to the repository configuration in
your project’s settings. This usually prevents the issue of having the
choice for multiple package version and results in a much smoother
experience when using OBS.</p>
</div>
</li>
<li><p>By default, OBS builds only a single build type and the default
profile. If your appliance uses multiple build types, put
each build type into a profile, as OBS cannot handle multiple build
types.</p>
<p>There are two options to build multiple profiles on OBS:</p>
<ol class="arabic">
<li><p>Use the <code class="xref py py-obj docutils literal notranslate"><span class="pre">&lt;image&gt;</span></code> element and add it bellow the XML
declaration (<code class="xref py py-obj docutils literal notranslate"><span class="pre">&lt;?xml</span> <span class="pre">..?&gt;</span></code>):</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>

<span class="c">&lt;!-- OBS-Profiles: foo_profile bar_profile --&gt;</span>

<span class="nt">&lt;image</span> <span class="na">schemaversion=</span><span class="s">&quot;7.1&quot;</span> <span class="na">name=</span><span class="s">&quot;openSUSE-Leap-15.1&quot;</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- image description with the profiles foo_profile and bar_profile</span>
<span class="c">&lt;/image&gt;</span>
</pre></div>
</div>
</li>
<li><p>Use the <a class="reference external" href="https://openbuildservice.org/help/manuals/obs-reference-guide/cha.obs.multibuild.html">multibuild</a> feature.</p></li>
</ol>
<p>The first option is simpler to use, but has the disadvantage that your
appliances are built sequentially. The <code class="xref py py-obj docutils literal notranslate"><span class="pre">multibuild</span></code> feature allows to
build each profile as a single package, thereby enabling parallel execution,
but requires an additional <code class="file docutils literal notranslate"><span class="pre">_multibuild</span></code> file. For the above example
<code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> would have to be adapted as follows:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="cp">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span>

<span class="c">&lt;!-- OBS-Profiles: @BUILD_FLAVOR@ --&gt;</span>

<span class="nt">&lt;image</span> <span class="na">schemaversion=</span><span class="s">&quot;7.1&quot;</span> <span class="na">name=</span><span class="s">&quot;openSUSE-Leap-15.1&quot;</span><span class="nt">&gt;</span>
  <span class="c">&lt;!-- image description with the profiles foo_profile and bar_profile</span>
<span class="c">&lt;/image&gt;</span>
</pre></div>
</div>
<p>The file <code class="file docutils literal notranslate"><span class="pre">_multibuild</span></code> would have the following contents:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;multibuild&gt;</span>
  <span class="nt">&lt;flavor&gt;</span>foo_profile<span class="nt">&lt;/flavor&gt;</span>
  <span class="nt">&lt;flavor&gt;</span>bar_profile<span class="nt">&lt;/flavor&gt;</span>
<span class="nt">&lt;/multibuild&gt;</span>
</pre></div>
</div>
</li>
<li><p>Subfolders in OBS projects are ignored by default by <strong class="command">osc</strong> and
must be explicitly added via <strong class="command">osc add $FOLDER</strong> <a class="footnote-reference brackets" href="#f2" id="id2">2</a>. Bear that
in mind when adding the overlay files inside the <code class="file docutils literal notranslate"><span class="pre">root/</span></code> directory
to your project.</p></li>
<li><p>OBS ignores file permissions. Therefore <code class="file docutils literal notranslate"><span class="pre">config.sh</span></code> and
<code class="file docutils literal notranslate"><span class="pre">images.sh</span></code> will <strong>always</strong> be executed through BASH (see also:
<a class="reference internal" href="../working_with_kiwi/shell_scripts.html#working-with-kiwi-user-defined-scripts"><span class="std std-ref">User Defined Scripts</span></a>).</p></li>
</ul>
</div>
<div class="section" id="recommendations">
<span id="obs-recommended-settings"></span><h2>Recommendations<a class="headerlink" href="#recommendations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="working-with-obs">
<h3>Working with OBS<a class="headerlink" href="#working-with-obs" title="Permalink to this headline">¶</a></h3>
<p>Although OBS is an online service, it is not necessary to test every change
by uploading it. OBS will use the same process as <code class="docutils literal notranslate"><span class="pre">osc</span> <span class="pre">build</span></code> does, so if
your image builds locally via <code class="docutils literal notranslate"><span class="pre">osc</span> <span class="pre">build</span></code> it should also build online on
OBS.</p>
</div>
<div class="section" id="repository-configuration">
<h3>Repository Configuration<a class="headerlink" href="#repository-configuration" title="Permalink to this headline">¶</a></h3>
<p>When setting up the project, enable the <code class="xref py py-obj docutils literal notranslate"><span class="pre">images</span></code> repository: the <code class="xref py py-obj docutils literal notranslate"><span class="pre">images</span></code>
repository’s checkbox can be found at the bottom of the selection screen
that appears when clicking <code class="xref py py-obj docutils literal notranslate"><span class="pre">Add</span> <span class="pre">from</span> <span class="pre">a</span> <span class="pre">Distribution</span></code> in the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Repositories</span></code>
tab. Or specify it manually in the project configuration (it can be
accessed via <code class="docutils literal notranslate"><span class="pre">osc</span> <span class="pre">meta</span> <span class="pre">-e</span> <span class="pre">prj</span></code>):</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;repository</span> <span class="na">name=</span><span class="s">&quot;images&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;arch&gt;</span>x86_64<span class="nt">&lt;/arch&gt;</span>
<span class="nt">&lt;/repository&gt;</span>
</pre></div>
</div>
<p>Furthermore, OBS requires additional repositories from which it obtains
your dependent packages. These repositories can be provided in two ways:</p>
<ol class="arabic">
<li><p>Add the repositories to the project configuration on OBS and omit them
from <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code>. Provide only the following repository inside
the image description:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;repository</span> <span class="na">type=</span><span class="s">&quot;rpm-md&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;source</span> <span class="na">path=</span><span class="s">&quot;obsrepositories:/&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/repository&gt;</span>
</pre></div>
</div>
<p>This instructs OBS to inject the repositories from your project into
your appliance.</p>
<p>Additional repositories can be added by invoking <code class="docutils literal notranslate"><span class="pre">osc</span> <span class="pre">meta</span> <span class="pre">-e</span> <span class="pre">prj</span></code> and
adding a line of the following form as a child of <code class="docutils literal notranslate"><span class="pre">&lt;repository</span>
<span class="pre">name=&quot;images&quot;&gt;</span></code>:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;path</span> <span class="na">project=</span><span class="s">&quot;$OBS_PROJECT&quot;</span> <span class="na">repository=</span><span class="s">&quot;$REPOSITORY_NAME&quot;</span><span class="nt">/&gt;</span>
</pre></div>
</div>
<p>The order in which you add repositories matters: if a package is present
in multiple repositories, then it is taken from the <strong>first</strong>
repository. The <strong>last</strong> repository is subject to path expansion: its
repository paths are included as well.</p>
<p>Don’t forget to add the repository from the
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Virtualization:Appliances:Builder</span></code> project, providing the latest stable
version of KIWI (which you are very likely using for your local builds).</p>
<p>The following example repository configuration <a class="footnote-reference brackets" href="#f3" id="id3">3</a> adds the
repositories from the <code class="xref py py-obj docutils literal notranslate"><span class="pre">Virtualization:Appliances:Builder</span></code> project and
those from the latest snapshot of openSUSE Tumbleweed:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;project</span> <span class="na">name=</span><span class="s">&quot;Virtualization:Appliances:Images:openSUSE-Tumbleweed&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;title&gt;</span>JeOS for Tumbleweed <span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;description&gt;</span>Host JeOS images for Tumbleweed<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;repository</span> <span class="na">name=</span><span class="s">&quot;images&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;path</span> <span class="na">project=</span><span class="s">&quot;Virtualization:Appliances:Builder&quot;</span> <span class="na">repository=</span><span class="s">&quot;Factory&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;path</span> <span class="na">project=</span><span class="s">&quot;openSUSE:Factory&quot;</span> <span class="na">repository=</span><span class="s">&quot;snapshot&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;arch&gt;</span>x86_64<span class="nt">&lt;/arch&gt;</span>
  <span class="nt">&lt;/repository&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</pre></div>
</div>
<p>The above can be simplified further using the path expansion of the last
repository to:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;project</span> <span class="na">name=</span><span class="s">&quot;Virtualization:Appliances:Images:openSUSE-Tumbleweed&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;title&gt;</span>JeOS for Tumbleweed <span class="nt">&lt;/title&gt;</span>
  <span class="nt">&lt;description&gt;</span>Host JeOS images for Tumbleweed<span class="nt">&lt;/description&gt;</span>
  <span class="nt">&lt;repository</span> <span class="na">name=</span><span class="s">&quot;images&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;path</span> <span class="na">project=</span><span class="s">&quot;Virtualization:Appliances:Builder&quot;</span> <span class="na">repository=</span><span class="s">&quot;Factory&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;arch&gt;</span>x86_64<span class="nt">&lt;/arch&gt;</span>
  <span class="nt">&lt;/repository&gt;</span>
<span class="nt">&lt;/project&gt;</span>
</pre></div>
</div>
<p>Now <code class="xref py py-obj docutils literal notranslate"><span class="pre">Virtualization:Appliances:Builder</span></code> is the last repository, which’
repositories are included into the search path. As
<code class="xref py py-obj docutils literal notranslate"><span class="pre">openSUSE:Factory/snapshot</span></code> is among these, it can be omitted from the
repository list.</p>
</li>
<li><p>Keep the repositories in your <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code> configuration file. If
you have installed the latest stable KIWI as described in
<a class="reference internal" href="../installation.html#kiwi-installation"><span class="std std-ref">Installation</span></a> then you should add the following repository to
your projects configuration (accessible via <strong class="command">osc meta -e
prjconf</strong>), so that OBS will pick the latest stable KIWI version too:</p>
<div class="highlight-xml notranslate"><div class="highlight"><pre><span></span><span class="nt">&lt;repository</span> <span class="na">name=</span><span class="s">&quot;images&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;path</span> <span class="na">project=</span><span class="s">&quot;Virtualization:Appliances:Builder&quot;</span> <span class="na">repository=</span><span class="s">&quot;$DISTRO&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;arch&gt;</span>x86_64<span class="nt">&lt;/arch&gt;</span>
<span class="nt">&lt;/repository&gt;</span>
</pre></div>
</div>
<p>Replace <code class="docutils literal notranslate"><span class="pre">$DISTRO</span></code> with the appropriate name for the distribution that
you are currently building and optionally adjust the architecture.</p>
</li>
</ol>
<p>We recommend to use the first method, as it integrates better into
OBS. Note that your image description will then no longer build outside of
OBS though. If building locally is required, use the second method.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Adding the repositories to project’s configuration makes it impossible
to build images for different distributions from the same project.</p>
<p>Since the repositories are added for every package in your project, all
your image builds will share the same repositories, thereby resulting in
conflicts for different distributions.</p>
<p>We recommend to create a separate project for each distribution. If that
is impossible, you can keep all your repositories (including
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Virtualization:Appliances:Builder</span></code>) in <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code>. That however
usually requires a large number of workarounds via <code class="xref py py-obj docutils literal notranslate"><span class="pre">Prefer:</span></code> settings in
the project configuration and is thus <strong>not</strong> recommended.</p>
</div>
</div>
<div class="section" id="project-configuration">
<h3>Project Configuration<a class="headerlink" href="#project-configuration" title="Permalink to this headline">¶</a></h3>
<p>The Open Build Service will by default create the same output file as KIWI
when run locally, but with a custom filename ending (that is unfortunately
unpredictable). This has the consequence that the download URL of your
image will change with every rebuild (and thus break automated
scripts). OBS can create symbolic links with static names to the latest
build by adding the following line to the project configuration:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Repotype: staticlinks
</pre></div>
</div>
<p>If build Vagrant images (see <a class="reference internal" href="working_with_images/vagrant_setup.html#setup-vagrant"><span class="std std-ref">KIWI Image Description for Vagrant</span></a>) add the repository-type
<code class="xref py py-obj docutils literal notranslate"><span class="pre">vagrant</span></code>. OBS creates a <code class="xref py py-obj docutils literal notranslate"><span class="pre">boxes/</span></code> subdirectory in your download
repositories, which contains JSON files for Vagrant <a class="footnote-reference brackets" href="#f4" id="id4">4</a>.</p>
<p>If you have added your repositories to <code class="file docutils literal notranslate"><span class="pre">config.xml</span></code>, you probably see
errors of the following type:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>unresolvable: have choice <span class="k">for</span> SOMEPACKAGE: SOMEPAKAGE_1 SOMEPACKAGE_2
</pre></div>
</div>
<p>Instead of starting from scratch and manually adding <code class="docutils literal notranslate"><span class="pre">Prefer:</span></code> statements
to the project configuration, we recommend to copy the current project
configuration of the testing project
<code class="xref py py-obj docutils literal notranslate"><span class="pre">Virtualization:Appliances:Images:Testing_$ARCH</span></code> into your own project.
It provides a good starting point and can be adapted to your OBS project.</p>
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>This is a design decision made by OBS: as it’s purpose is to build
packages in a reproducible fashion it cannot make a decision which
package to choose from multiple available ones. A package manager build
for end-users on the other hand <strong>must</strong> make an a choice, as it would
be otherwise hardly usable.</p>
</dd>
<dt class="label" id="f2"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p><code class="file docutils literal notranslate"><span class="pre">osc</span></code> compresses added folders into a <a class="reference external" href="https://en.wikipedia.org/wiki/Cpio">cpio</a> archive and decompresses it
before running your builds. The only downside of this is, that the
contents of your overlay is not conveniently visible via the web
interface.</p>
</dd>
<dt class="label" id="f3"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><p>Taken from the project
<a class="reference external" href="https://build.opensuse.org/project/show/Virtualization:Appliances:Images:openSUSE-Tumbleweed">Virtualization:Appliances:Images:openSUSE-Tumbleweed</a></p>
</dd>
<dt class="label" id="f4"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><p>Vagrant uses these JSON files for automatic updates of your
Vagrant boxes.</p>
</dd>
</dl>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="working_with_images.html" class="btn btn-neutral float-right" title="Working with Images" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="build_with_profiles.html" class="btn btn-neutral float-left" title="Building Images with Profiles" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Marcus Schäfer

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>